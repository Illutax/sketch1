let p=
[
    [
        [[0,1],[0,2],[0,2],[1,2]],
        [[3,1],[1,0],[2,1],[1,3]],
        [[3,1],[1,3],[3,1],[1,3]],
        [[3,1],[1,3],[3,1],[1,3]],
        [[3,1],[0,3],[3,2],[1,3]],
        [[3,0],[2,0],[2,0],[2,3]],
    ],[
        [[0,0],[0,0],[0,1],[1,2]],
        [[0,0],[0,0],[3,1],[1,3]],
        [[0,0],[0,0],[3,1],[1,3]],
        [[0,0],[0,0],[3,1],[1,3]],
        [[0,0],[0,0],[3,1],[1,3]],
        [[0,0],[0,0],[3,0],[2,3]],
    ],[
        [[0,1],[0,2],[0,2],[1,2]],
        [[3,0],[2,0],[2,1],[1,3]],
        [[0,1],[0,2],[3,2],[1,3]],
        [[3,1],[1,0],[2,0],[2,3]],
        [[3,1],[0,3],[0,2],[1,2]],
        [[3,0],[2,0],[2,0],[2,3]],
    ],[
        [[0,1],[0,2],[0,2],[1,2]],
        [[3,0],[2,0],[2,1],[1,3]],
        [[0,1],[0,2],[3,2],[1,3]],
        [[3,0],[2,0],[2,1],[1,3]],
        [[0,1],[0,2],[3,2],[1,3]],
        [[3,0],[2,0],[2,0],[2,3]],
    ],[
        [[0,1],[1,2],[0,1],[1,2]],
        [[3,1],[1,3],[3,1],[1,3]],
        [[3,1],[0,3],[3,2],[1,3]],
        [[3,0],[2,0],[2,1],[1,3]],
        [[0,0],[0,0],[3,1],[1,3]],
        [[0,0],[0,0],[3,0],[2,3]],
    ],[
        [[0,1],[0,2],[0,2],[1,2]],
        [[3,1],[1,0],[2,0],[2,3]],
        [[3,1],[0,3],[0,2],[1,2]],
        [[3,0],[2,0],[2,1],[1,3]],
        [[0,1],[0,2],[3,2],[1,3]],
        [[3,0],[2,0],[2,0],[2,3]],
    ],[
        [[0,1],[0,2],[0,2],[1,2]],
        [[3,1],[1,0],[2,0],[2,3]],
        [[3,1],[0,3],[0,2],[1,2]],
        [[3,1],[1,0],[2,1],[1,3]],
        [[3,1],[0,3],[3,2],[1,3]],
        [[3,0],[2,0],[2,0],[2,3]],
    ],[
        [[0,1],[0,2],[0,2],[1,2]],
        [[3,0],[2,0],[2,1],[1,3]],
        [[0,0],[0,0],[3,1],[1,3]],
        [[0,0],[0,0],[3,1],[1,3]],
        [[0,0],[0,0],[3,1],[1,3]],
        [[0,0],[0,0],[3,0],[2,3]],
    ],[
        [[0,1],[0,2],[0,2],[1,2]],
        [[3,1],[1,0],[2,1],[1,3]],
        [[3,1],[0,3],[3,2],[1,3]],
        [[3,1],[1,0],[2,1],[1,3]],
        [[3,1],[0,3],[3,2],[1,3]],
        [[3,0],[2,0],[2,0],[2,3]],
    ],[
        [[0,1],[0,2],[0,2],[1,2]],
        [[3,1],[1,0],[2,1],[1,3]],
        [[3,1],[0,3],[3,2],[1,3]],
        [[3,0],[2,0],[2,1],[1,3]],
        [[0,0],[0,0],[3,1],[1,3]],
        [[0,0],[0,0],[3,0],[2,3]],
    ]
    
];

let n=0;

function setup(){
    createCanvas(windowWidth,windowHeight);
}

function draw(){
    background(255);
    let m;
    m=0.5+0.5*cos(PI+PI*((frameCount%100)/100));
    if(frameCount%100==0)   n=(n+1)%10;
    disp(100,100,100,n,(n+1)%10,m);

    /*disp(100,700,100,3,4,mouseX/width);   //move mouse left to right*/ 
}

function disp(r,x,y,n1,n2,m){   //n1,n2:0~9,m:0~1
    noStroke();
    for(let i=0;i<4;i++)    for(let j=0;j<6;j++){
        fill(220);
        circle(x+r*i,y+r*j,r);
        fill('#ff7300');
        arc(x+r*i,y+r*j,r,r,
            PI/2*rot(p[n1][j][i],p[n2][j][i],m)[0],PI/2*rot(p[n1][j][i],p[n2][j][i],m)[1]);
    }
}

function rot(a,b,c){
    let result=new Array(2);
    let d=pis(b[0],b[1])-pis(a[0],a[1]);
    let f=0,g=0;

    if(b[0]==0&&b[1]==0){
        if(a[1]<a[0])   f=4;
        result=[a[0]+(a[1]+f-a[0])/2*c,a[1]+f+(a[0]-a[1]-f)/2*c];
    }else if(a[0]==0&&a[1]==0){
        if(b[1]<b[0])   f=4;
        result=[(b[0]+b[1]+f)/2*(1-c)+c*b[0],(b[0]+b[1]+f)/2*(1-c)+(f+b[1])*c];
    }else{
        if(a[0]==0&&b[0]==3)    f=4;
        if(b[0]==0&&a[0]==3)    g=4;    
        result[0]=(a[0]+f)*(1-c)+(b[0]+g)*c;
        result[1]=result[0]+a[1]-(a[0]+f)+d*c;
    }
    return result;
}

function pis(a,b){
    if(a<b) return b-a;
    else return (4-a)+b;
}

